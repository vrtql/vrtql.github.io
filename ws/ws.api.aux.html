<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>2. Common Facilities</title><link rel="stylesheet" type="text/css" href="screen.css"><link rel="stylesheet" type="text/css" href="docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.2"><link rel="home" href="ws.html" title="VRTQL WebSocket Library"><link rel="up" href="ws.api.html" title="Chapter 2. C API"><link rel="prev" href="ws.api.html" title="Chapter 2. C API"><link rel="next" href="ws.api.msg.html" title="3. The Message API"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header" class="navtable"><tr><th colspan="3" align="center">2. Common Facilities</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ws.api.html">Prev</a> </td><th width="60%" align="center">Chapter 2. C API</th><td width="20%" align="right"> <a accesskey="n" href="ws.api.msg.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ws.api.aux"></a>2. Common Facilities</h2></div></div></div><p>The common facilities encompass error handling, memory management, and
tracing. These are consolidated in a thread-local global variable named
<code class="classname"><a xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:d="http://docbook.org/ns/docbook" href="https://vrtql.github.io/ws-code-doc/root/codebrowser/src/vrtql.h.html#vrtql">vrtql</a></code>. As this variable is
thread-local, each thread maintains its independent copy.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ws.api.aux.errors"></a>2.1. Error Handling</h3></div></div></div><p>Error handling in the API is facilitated through the usage of a code and a
human-readable string. These are encapsulated within an instance of the
<code class="classname"><a xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:d="http://docbook.org/ns/docbook" href="https://vrtql.github.io/ws-code-doc/root/codebrowser/src/vrtql.h.html#vrtql_error_value">vrtql_error_value</a></code> structure, kept in
<code class="varname">vrtql.e</code> member. Error handling is done through the
<code class="function">vrtql.error()</code> and
<code class="function">vrtql.process_error()</code> function pointers. The
<code class="function">vrtql.error()</code> function submits an error for processing and
the <code class="function">vrtql.process_error()</code> takes action on the error. You
can customize both of these handlers by assiging them to different
functions. The default implementation for <code class="function">vrtql.error()</code> is
<code class="function"><a xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:d="http://docbook.org/ns/docbook" href="https://vrtql.github.io/ws-code-doc/root/codebrowser/src/vrtql.c.html#vrtql_error_default_submit">vrtql_error_default_submit</a>()</code> whereas
the default implementation for <code class="function">vrtql.process_error()</code> is
<code class="function"><a xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:d="http://docbook.org/ns/docbook" href="https://vrtql.github.io/ws-code-doc/root/codebrowser/src/vrtql.c.html#vrtql_error_default_process">vrtql_error_default_process</a>()</code>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ws.api.aux.tracing"></a>2.2. Tracing</h3></div></div></div><p>Tracing is a mechanism for logging debug information and is managed by the
<code class="function">vrtql.trace()</code> function. Tracing outputs log messages
associated with different severity levels (DEBUG, INFO, WARNING, ERROR), with
the level determined by the first parameter of
<code class="varname">vrtql.tracelevel</code>. The default level is zero which disables
all tracing. Other levels are defined by the <code class="classname"><a xmlns:fo="http://www.w3.org/1999/XSL/Format" xmlns:d="http://docbook.org/ns/docbook" href="https://vrtql.github.io/ws-code-doc/root/codebrowser/src/message.h.html#vrtql_tl_t">vrtql_tl_t</a></code> enum.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ws.api.aux.memory"></a>2.3. Memory Management</h3></div></div></div><p>The library provides memory management functions that include error
handling mechanisms. These functions are <code class="function">vrtql.malloc()</code>,
<code class="function">vrtql.calloc()</code>, <code class="function">vrtql.realloc()</code> and
<code class="function">vrtql.free()</code>. These all call the underlying OS functions
but you can provide alternate implementations by assiging new functions.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer" class="navtable"><tr><td width="40%" align="left"><a accesskey="p" href="ws.api.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ws.api.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="ws.api.msg.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 2. C API </td><td width="20%" align="center"><a accesskey="h" href="ws.html">Home</a></td><td width="40%" align="right" valign="top"> 3. The Message API</td></tr></table></div></body></html>
